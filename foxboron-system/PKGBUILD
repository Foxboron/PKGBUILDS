# Maintainer: Morten Linderud <morten@linderud.pw>

pkgbase=foxboron-system
pkgname=('base-system'
         'theia-system'
         'foxboron-timers'
         'foxboron-backup'
         'foxboron-fontconfig'
         'foxboron-acpid'
         'foxboron-x11'
         'foxboron-bfq'
         )
pkgver=1
pkgrel=2
pkgdesc="System configs"
arch=("any")
url="https://velox.pw/"
license=('MIT')
source=('timers-timer@.timer'
        'timers-timer@.target'
        'backup-backup'
        'backup-backup-sudo'
        'backup-sudoers'
        'backup-backup@.service'
        'backup-snapper-filter'
        'backup-snapper-backup.service'
        'backup-snap-boot-backup'
        'backup-50_bootbackup.hook'
        'backup-zz_bootback.hook'
        'backup-snap-boot-config'
        'backup-backup-snapper-cleanup.service'
        'system-sudoers'
        'theia-capslock.hwdb'
        'theia-thinkfan.conf'
        'theia-thinkpad_acpi.conf'
        'fontconfig-local.conf'
        'acpid-thinkpad-dock-lenovo'
        'acpid-thinkpad-undock-lenovo'
        'acpid-thinkpad-dock.sh'
        'acpid-thinkpad-undock.sh'
        'x11-99-keyboard.conf'
        'bfq-60-scheduler.rules'
        )

sha256sums=('dd01c47408e67c0af174345fb1bd92683d509181a0d8bf8fc1e22ba49e79ec24'
            '148cffd0796d1fa2b1d9bba9274493bd9cfc2d5a524ffc0e03fc2d6e8e2c53fb'
            '88f44eecb9c538889f4eacf439cfd605a5a58841bf1c55e26693354cb02313a7'
            'f5252e9184f5469bb7d4091359f752674b5925efe670a19aa65177b7409713b5'
            '9eae320f6f0842d0692d46020125432350ed25fbddec2d9829d16ca7f43991c5'
            'a0b5613069aaf7929e6d83308536495066bcda68e9c3e4e7a923c10a5a1eaa86'
            'b17747590458e5e540fad94dc046348f32b4e84565078c5609a824784163f6d2'
            'fde7844e13e00125ad13bd87e0bc3f2347ce7424c054b1e2ade44ea05e1176fd'
            '48ee59b2d3d2c6839825177a31f7efa6b4f4c7d43139409d63676c7955affb0b'
            '6856ba88cb90e2f0133c81e26214bd4c4a0c1990a12ebbd34b4cda088be4cf8d'
            '400935dff56e2f8e00fad3e24025f08924722f2fbe023d75d755bc19ca4e4fbd'
            '2a978ea589fa3647d6156bdd054c5c76828b8934c832423f9d3a3db9e5e5019a'
            '08e1d51e9559f89f8d6a57a3134b05295d8ace56cddac3aa97a0f3792b68ee91'
            '9db7f67e68218e51ee549cba0949aae86b6c14a48ac40b851cf76aba951f70a7'
            '825f6500e22b3f8a9ecde110cb14c51a97399481b33123981d1f950dccc268a3'
            '2e15377025beca05b6a1f82bf7e17da3389bae718a5d720384b2ff72bbeb9ec2'
            '28874576641b3cc1aa486e1bc9ed40eadfe8b13d6d3014016e31fedc5dc5195f'
            'd685385b3a92fbac8f0c63175ae0a0f97b724c5a774f0452c884693902f5e1bf'
            '16f2124165aaeea64670460718b1f0e826483d4e8b4f2aceb09ab145db3b542d'
            'fe14f948f05526499db04831cd01c12f80ffac33176142d5bc9b39f3fecedf33'
            'fe508fb33786cda8f858f5a1e804b4f8cea13b523e99e857dcf66b49ad7d1965'
            '64d013589348bb5ca5767284b179188bc6f4761b3846590a10e9c3b809672480'
            '477185de77c1cff69e9b7c9e5451fc71294c00c407726f87e29324f34379c01f'
            '24f196f2369798d8c495d1b811aa13885eef28dc0c7be614d2ac2ee679f4f4f7')

package_foxboron-packages(){
    depend=('gvim', 'feh', 'ctags', 'feh', 'tlp', 'udiskie',
    'gnupg', 'pass', 'htop', 'stow', 'xorg-xinit', 'xorg-server',
    'xbindkeys', 'xorg-setxkbdmap', 'xdotool', 'mpv', 'ttf-dejavu',
    'noto-fonts', 'unclutter', 'compton', 'rofi', 'termite',
    'lm_sensors', 'pulseaudio', 'pulseadui-alsa', 'pavucontrol',
    'alsa-utils', 'mosh', 'ssh', 'qutebrowser', 'chromium', 'task',
    'mutt', 'xf86-video-intel' , 'gtk2', 'redshift', 'zathura',
    'zathura-pdf-mupdf', 'i3lock', 'imv', 'playerctl', 'task',
    'urlwatch', 'python-beautifulsoup4' 'xorg-xset' 'dunst' 'mpv'
    'expac')
}

package_base-system(){
    # depends=('sudo', 'zsh' 'vim')

    # aur
    # i3-gaps
    # ttf-icons
    install -d 0750 "$pkgdir"/etc/sudoers.d/system
    install -Dm0644 system-sudoers "$pkgdir"/etc/sudoers.d/system
}

package_theia-system(){
    depends=('base-system')
    # Fix thinkfan
    install -Dm0644 theia-capslock.hwdb "$pkgdir"/etc/udev/hwdb.d/61-theia-capslock.hwdb
    install -Dm0644 theia-thinkfan.conf "$pkgdir"/etc/thinkfan.conf
    install -Dm0644 theia-thinkpad_acpi.conf "$pkgdir"/etc/modprobe.d/thinkpad_acpi.conf
}

package_foxboron-timers(){
    install=timers.install
    install -Dm0644 timers-timer@.target "$pkgdir"/usr/lib/systemd/system/timer@.target
    install -Dm0644 timers-timer@.timer "$pkgdir"/usr/lib/systemd/system/timer@.timer
}

package_foxboron-backup(){
    # This really needs to be factored so we dont rely on bad dotfiles
    depends=('foxboron-timers' 'snapper' 'expac')
    install -Dm0644 backup-backup@.service "$pkgdir"/usr/lib/systemd/system/backup@.service
    install -Dm0644 backup-snapper-backup.service "$pkgdir"/usr/lib/systemd/system/snapper-backup.service
    install -d 0750 "$pkgdir"/etc/sudoers.d
    install -Dm0644 backup-sudoers "$pkgdir"/etc/sudoers.d/backup
    install -Dm0755 backup-backup "$pkgdir"/usr/bin/backup
    install -Dm0755 backup-backup-sudo "$pkgdir"/usr/bin/backup-sudo
}

package_foxboron-pacman-backup(){
    # This really needs to be factored so we dont rely on bad dotfiles
    depends=('foxboron-pacman-backup')
    install -Dm0755 backup-snap-boot-backup "$pkgdir"/usr/bin/snap-boot-back
    install -Dm0644 backup-50_bootbackup.hook "$pkgdir"/usr/share/libalpm/hooks/50_bootbackup.hook
    install -Dm0644 backup-zz_bootback.hook "$pkgdir"/usr/share/libalpm/hooks/zz_bootback.hook
    install -Dm0644 backup-snap-boot-config "$pkgdir"/usr/share/$pkgname/snap-boot.config
}

package_foxboron-fontconfig(){
    depends=('ttf-hack' 'noto-fonts-emoji')
    install -Dm0644 fontconfig-local.conf "$pkgdir"/etc/fonts/local.conf
}
package_foxboron-acpid(){
    depends=('acpid') 
    install -Dm0644 acpid-thinkpad-dock-lenovo "$pkgdir"/etc/acpi/events/thinkpad-dock-lenovo
    install -Dm0644 acpid-thinkpad-undock-lenovo "$pkgdir"/etc/acpi/events/thinkpad-undock-lenovo
    install -Dm0755 acpid-thinkpad-undock.sh "$pkgdir"/etc/acpi/thinkpad-undock.sh
    install -Dm0755 acpid-thinkpad-dock.sh "$pkgdir"/etc/acpi/thinkpad-dock.sh
}

package_foxboron-x11(){
    install -Dm0644 x11-99-keyboard.conf "$pkgdir"/etc/X11/xorg.conf.d/99-keyboard.conf
}

package_foxboron-bfq(){
    install -Dm0644 bfq-60-scheduler.rules "$pkgdir"/etc/udev/rules.d/60-scheduler.rules
}

package_foxboron-yubikey(){
    depends=()
    # pcsc-tools
    # yubikey-manager
    # udevrules
}

package_foxboron-wireguard(){
    depends=('wireguard-dkms' 'wireguard-tools')
}

# Add tlp btrfs fix
